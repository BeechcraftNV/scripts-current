#!/bin/bash
# build-welcome-site - Build and deploy LAN welcome page with Hugo/Caddy

set -euo pipefail

echo "ğŸŒ Building LAN Welcome Site..."

SITE_NAME="lan-welcome"
SITE_ROOT="$HOME/Sites/$SITE_NAME"
THEME_NAME="PaperMod"
CADDY_TARGET="/etc/caddy/site/$SITE_NAME"

echo "ğŸ§¹ Removing old site..."
rm -rf "$SITE_ROOT"
mkdir -p "$SITE_ROOT"
cd "$SITE_ROOT"

echo "ğŸš€ Creating new Hugo site..."
hugo new site . --force

echo "ğŸ¨ Installing PaperMod theme..."
git init
git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/$THEME_NAME

# Create config file
cat <<EOF > hugo.toml
baseURL = "http://lmdeserver"
languageCode = "en-us"
title = "LAN Welcome"
theme = "$THEME_NAME"
EOF

echo "ğŸ“ Creating homepage content..."
mkdir -p content
cat <<EOF > content/_index.md
---
title: "Welcome to Your LAN"
---

<style>
h1 { color: #2e8b57; font-size: 2.2em; }
ul li { margin-bottom: 0.5em; }
a { color: #1e90ff; }
</style>

![Welcome Image](https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Globe_icon.svg/512px-Globe_icon.svg.png)

## Local Services

- [Sonarr](http://sonarr.lan)
- [Radarr](http://radarr.lan)
- [Readarr](http://readarr.lan)
- [Bazarr](http://bazarr.lan)
- [Prowlarr](http://prowlarr.lan)
- [NZBHydra2](http://nzbhydra2.lan)
- [NZBGet](http://nzbget.lan)
- [Pi-hole](http://pihole.lan)

## External Links

- [Cromoneter](https://cromoneter.com/)
EOF

echo "ğŸ”¨ Building site..."
hugo

echo "ğŸ”— Linking to Caddy directory..."
sudo mkdir -p "$(dirname "$CADDY_TARGET")"
sudo ln -sfn "$SITE_ROOT/public" "$CADDY_TARGET"

echo "ğŸ”„ Reloading Caddy..."
sudo caddy reload --config /etc/caddy/Caddyfile

echo "âœ… Done. Visit: http://lmdeserver"



#!/bin/bash
# morning-tabs - Open morning routine URLs in Brave browser
# Reads URLs from ~/morning-urls.txt (one URL per line, # for comments)

set -euo pipefail

SCRIPT_DIR="$(dirname "$0")"
URL_FILE="$SCRIPT_DIR/morning-urls.txt"

if [[ ! -f "$URL_FILE" ]]; then
    # Fallback to home directory
    URL_FILE="$HOME/morning-urls.txt"
fi

if [[ ! -f "$URL_FILE" ]]; then
    echo "Error: morning-urls.txt not found in $SCRIPT_DIR or $HOME"
    exit 1
fi

if ! command -v brave-browser &>/dev/null; then
    echo "Error: brave-browser not found in PATH"
    exit 1
fi

while IFS= read -r url || [[ -n "$url" ]]; do
    [[ "$url" =~ ^# ]] && continue  # Skip comments
    [[ -z "$url" ]] && continue     # Skip blank lines
    brave-browser "$url" &>/dev/null &
    sleep 0.3  # Brief delay to preserve tab order
done < "$URL_FILE"

disown -a  # Detach all background jobs for clean exit
